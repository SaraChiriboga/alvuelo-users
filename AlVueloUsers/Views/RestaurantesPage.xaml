<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AlVueloUsers.Views.RestaurantesPage"
             BackgroundColor="#FFFFFF"
             NavigationPage.HasNavigationBar="False">

    <Grid RowDefinitions="Auto,Auto,Auto,*,Auto"
          RowSpacing="0">

        <!-- HEADER CON DEGRADADO -->
        <Grid Grid.Row="0" 
              BackgroundColor="#FF6B6B"
              Padding="24,50,24,24">

            <VerticalStackLayout Spacing="8">
                <Label Text="Â¡Hola! ðŸ‘‹"
                       FontSize="24"
                       TextColor="#FFFFFF"
                       Opacity="0.9"/>

                <Label Text="Â¿QuÃ© te antoja hoy?"
                       FontSize="28"
                       FontAttributes="Bold"
                       TextColor="#FFFFFF"
                       Padding="10"/>
                
            </VerticalStackLayout>
        </Grid>

        <!-- BUSCADOR FLOTANTE -->
        
        <Frame Grid.Row="1"
               BackgroundColor="#FFFFFF"
               CornerRadius="28"
               HasShadow="True"
               Margin="20,-28,20,0"
               Padding="10"
               HeightRequest="56">

            <Grid ColumnDefinitions="56,*,56" ColumnSpacing="0">


                <SearchBar x:Name="SearchRest"
                           Grid.Column="1"
                           Placeholder="Buscar restaurantes..."
                           HorizontalOptions="Start"
                           TextChanged="OnBuscarChanged"
                           BackgroundColor="Transparent"
                           TextColor="#1A1A1A"
                           PlaceholderColor="#999999"
                           FontSize="15"/>
            </Grid>
        </Frame>

        <!-- FILTRO CAMPUS -->
        <ScrollView Grid.Row="2" 
                    Orientation="Horizontal"
                    HorizontalScrollBarVisibility="Never"
                    Padding="20,20,20,16">

            <HorizontalStackLayout Spacing="12">
                <!-- Campus Filter -->
                <Frame BackgroundColor="#FF6B6B"
                       CornerRadius="29"
                       HasShadow="False"
                       Padding="35,9"
                       BorderColor="#FF6B6B"
                       Opacity="100">

                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnCampusChipTapped"/>
                    </Frame.GestureRecognizers>

                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="8">
                        <Picker x:Name="PickerCampus"
                                Title="UdlaPark"
                                SelectedIndexChanged="OnCampusChanged"
                                BackgroundColor="White"
                                TextColor="White"
                                TitleColor="White"
                                Opacity="0.01"
                                HorizontalOptions="Fill"/>

                        <Label x:Name="LblCampus"
                               Text="ðŸ“ UdlaPark"
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="White"
                               VerticalOptions="Center"/>

                        <Label Grid.Column="1"
                               Text="&#xF078;"
                               FontFamily="FASolid"
                               FontSize="10"
                               TextColor="White"
                               VerticalOptions="Center"/>
                    </Grid>
                </Frame>

                <!-- Filtros adicionales opcionales -->
                <Frame BackgroundColor="#F8F8F8"
                       CornerRadius="20"
                       HasShadow="False"
                       Padding="20,12">
                    <Label Text="âš¡ MÃ¡s rÃ¡pidos"
                           FontSize="14"
                           TextColor="#666666"/>
                </Frame>

                <Frame BackgroundColor="#F8F8F8"
                       CornerRadius="20"
                       HasShadow="False"
                       Padding="20,12">
                    <Label Text="â­ Mejor valorados"
                           FontSize="14"
                           TextColor="#666666"/>
                </Frame>
            </HorizontalStackLayout>
        </ScrollView>

        <!-- LISTA RESTAURANTES -->
<CollectionView Grid.Row="3"
                x:Name="ListaRestaurantes"
                SelectionMode="None"
                Margin="20,0">

    <CollectionView.ItemsLayout>
        <LinearItemsLayout Orientation="Vertical" ItemSpacing="16"/>
    </CollectionView.ItemsLayout>

    <CollectionView.ItemTemplate>
        <DataTemplate>
            <Frame BackgroundColor="#FFFFFF"
                   CornerRadius="20"
                   HasShadow="True"
                   Padding="0"
                   Margin="0,4">

                <Frame.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnRestauranteSeleccionado"
                                          CommandParameter="{Binding .}" />
                </Frame.GestureRecognizers>

                <Grid RowDefinitions="140,Auto" RowSpacing="0">

                    <!-- IMAGEN/LOGO DE FONDO -->
                    <Grid Grid.Row="0">
                        <Frame BackgroundColor="#FFF5F5"
                               CornerRadius="20"
                               HasShadow="False"
                               Padding="16">

                            <Image Source="{Binding LogoUrl}"
                                   Aspect="AspectFit"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   HeightRequest="100"/>
                        </Frame>

                        <!-- Badge de tiempo -->
                        <Frame BackgroundColor="#FFFFFF"
                               CornerRadius="16"
                               HasShadow="True"
                               Padding="12,6"
                               HorizontalOptions="End"
                               VerticalOptions="Start"
                               Margin="16">

                            <HorizontalStackLayout Spacing="4">
                                <Label Text="ðŸ•"
                                       FontSize="12"
                                       VerticalOptions="Center"/>
                                <Label Text="{Binding TiempoEstimado, FallbackValue='3 min'}"
                                       FontSize="12"
                                       FontAttributes="Bold"
                                       TextColor="#1A1A1A"
                                       VerticalOptions="Center"/>
                            </HorizontalStackLayout>
                        </Frame>
                    </Grid>

                    <!-- INFO -->
                    <VerticalStackLayout Grid.Row="1"
                                         Padding="16"
                                         Spacing="8">

                        <Label Text="{Binding Nombre}"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#1A1A1A"
                               LineBreakMode="TailTruncation"/>

                        <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                            <HorizontalStackLayout Spacing="4">
                                <Label Text="ðŸ“"
                                       FontSize="12"
                                       VerticalOptions="Center"/>
                                <Label Text="{Binding Campus}"
                                       FontSize="13"
                                       TextColor="#666666"
                                       VerticalOptions="Center"/>
                            </HorizontalStackLayout>

                            <HorizontalStackLayout Grid.Column="2"
                                                  Spacing="4"
                                                  HorizontalOptions="End">
                                <Label Text="â­"
                                       FontSize="13"
                                       VerticalOptions="Center"/>
                                <Label Text="4.8"
                                       FontSize="13"
                                       FontAttributes="Bold"
                                       TextColor="#1A1A1A"
                                       VerticalOptions="Center"/>
                            </HorizontalStackLayout>
                        </Grid>
                    </VerticalStackLayout>

                </Grid>
            </Frame>
        </DataTemplate>
    </CollectionView.ItemTemplate>
</CollectionView>

        <!-- BOTTOM BAR -->
        <Border Grid.Row="4"
        BackgroundColor="#FFFFFF"
        StrokeThickness="0"
        Margin="1"
        Padding="20,16,20,24">

            <Border.StrokeShape>
                <RoundRectangle CornerRadius="28" />
            </Border.StrokeShape>

            <Border.Shadow>
                <Shadow Brush="#000000"
                Opacity="0.18"
                Radius="18"
                Offset="0,-6" />
            </Border.Shadow>

            <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="0">

                <!-- Home -->
                <VerticalStackLayout Spacing="4">
                    <Label Text="&#xF015;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#FF6B6B"
                   HorizontalOptions="Center" />
                    <Label Text="Inicio"
                   FontSize="11"
                   TextColor="#FF6B6B"
                   FontAttributes="Bold"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

                <!-- Carrito -->
                <VerticalStackLayout Grid.Column="1" Spacing="4">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnCarritoClicked" />
                    </VerticalStackLayout.GestureRecognizers>

                    <Label Text="&#xF07A;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#CCCCCC"
                   HorizontalOptions="Center" />
                    <Label Text="Carrito"
                   FontSize="11"
                   TextColor="#999999"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

                <!-- Favoritos -->
                <VerticalStackLayout Grid.Column="2" Spacing="4">
                    <Label Text="&#xF004;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#CCCCCC"
                   HorizontalOptions="Center" />
                    <Label Text="Favoritos"
                   FontSize="11"
                   TextColor="#999999"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

                <!-- Pedidos -->
                <VerticalStackLayout Grid.Column="3" Spacing="4">
                    <Label Text="&#xF0F3;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#CCCCCC"
                   HorizontalOptions="Center" />
                    <Label Text="Pedidos"
                   FontSize="11"
                   TextColor="#999999"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

            </Grid>
        </Border>

    </Grid>
</ContentPage>
