<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AlVueloUsers.Views.CarritoPage"
             BackgroundColor="#FAFAFA"
             NavigationPage.HasNavigationBar="False">

    <Grid RowDefinitions="Auto,Auto,*,Auto,Auto"
          RowSpacing="0">

        <!-- HEADER -->
        <Grid Grid.Row="0" 
              BackgroundColor="#FFFFFF"
              Padding="20,50,20,24">

            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">

                <!-- BotÃ³n Back -->
                <Frame WidthRequest="44"
                       HeightRequest="44"
                       CornerRadius="22"
                       BackgroundColor="#F8F8F8"
                       HasShadow="False"
                       Padding="0">
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnBackTapped"/>
                    </Frame.GestureRecognizers>
                    <Label Text="&#xF060;"
                           FontFamily="FASolid"
                           FontSize="16"
                           TextColor="#1A1A1A"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"/>
                </Frame>

                <!-- TÃ­tulo centrado -->
                <VerticalStackLayout Grid.Column="1"
                                     Spacing="4"
                                     HorizontalOptions="Center"
                                     VerticalOptions="Center">
                    <Label Text="Mi Carrito"
                           FontSize="22"
                           FontAttributes="Bold"
                           TextColor="#1A1A1A"
                           HorizontalOptions="Center"/>

                    <Label x:Name="LblCantidadItems"
                           Text="3 items"
                           FontSize="13"
                           TextColor="#999999"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>

                <!-- Icono carrito -->
                <Frame WidthRequest="44"
                       HeightRequest="44"
                       CornerRadius="22"
                       BackgroundColor="#FFF5F5"
                       HasShadow="False"
                       Padding="0">
                    <Label Text="ðŸ›’"
                           FontSize="22"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"/>
                </Frame>

            </Grid>
        </Grid>


        <!-- LISTA CARRITO -->
        <ScrollView Grid.Row="2">
            <VerticalStackLayout Padding="20,16" Spacing="12">

                <CollectionView x:Name="ListaCarrito"
                                SelectionMode="None">

                    <CollectionView.ItemsLayout>
                        <LinearItemsLayout Orientation="Vertical" ItemSpacing="12"/>
                    </CollectionView.ItemsLayout>

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame BackgroundColor="#FFFFFF"
                                   CornerRadius="20"
                                   HasShadow="True"
                                   Padding="12"
                                   Margin="0,2">

                                <Grid ColumnDefinitions="80,*,Auto"
                                      RowDefinitions="Auto,Auto,Auto"
                                      ColumnSpacing="12"
                                      RowSpacing="8">

                                    <!-- Imagen -->
                                    <Frame Grid.RowSpan="3"
                                           BackgroundColor="#F8F8F8"
                                           CornerRadius="16"
                                           HasShadow="False"
                                           WidthRequest="80"
                                           HeightRequest="80"
                                           Padding="0"
                                           VerticalOptions="Start">
                                        <Image Source="{Binding Plato.ImagenUrl}"
                                               Aspect="AspectFill"/>
                                    </Frame>

                                    <!-- Nombre -->
                                    <Label Grid.Column="1"
                                           Grid.Row="0"
                                           Text="{Binding Plato.Nombre}"
                                           FontSize="15"
                                           FontAttributes="Bold"
                                           TextColor="#1A1A1A"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="2"/>

                                    <!-- Precio unitario -->
                                    <Label Grid.Column="1"
                                           Grid.Row="1"
                                           Text="{Binding Plato.Precio, StringFormat='${0:F2} c/u'}"
                                           FontSize="13"
                                           TextColor="#999999"/>

                                    <!-- Precio total del item -->
                                    <Label Grid.Column="1"
                                           Grid.Row="2"
                                           Text="{Binding Subtotal, StringFormat='${0:F2}'}"
                                           FontSize="16"
                                           FontAttributes="Bold"
                                           TextColor="#FF6B6B"/>


                                    <!-- Control cantidad -->
                                    <Frame Grid.Column="2"
                                           Grid.RowSpan="3"
                                           BackgroundColor="#F8F8F8"
                                           CornerRadius="20"
                                           HasShadow="False"
                                           Padding="4"
                                           VerticalOptions="Center">

                                        <Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="8">

                                            <!-- + -->
                                            <Frame BackgroundColor="#FF6B6B"
                                                   CornerRadius="16"
                                                   HasShadow="False"
                                                   WidthRequest="32"
                                                   HeightRequest="32"
                                                   Padding="0">
                                                <Frame.GestureRecognizers>
                                                    <TapGestureRecognizer Tapped="OnMasTapped"
                                                                          CommandParameter="{Binding .}"/>
                                                </Frame.GestureRecognizers>
                                                <Label Text="+"
                                                       FontSize="18"
                                                       FontAttributes="Bold"
                                                       TextColor="#FFFFFF"
                                                       HorizontalOptions="Center"
                                                       VerticalOptions="Center"/>
                                            </Frame>

                                            <!-- Cantidad -->
                                            <Label Grid.Row="1"
                                                   Text="{Binding Cantidad}"
                                                   FontSize="15"
                                                   FontAttributes="Bold"
                                                   TextColor="#1A1A1A"
                                                   VerticalOptions="Center"
                                                   HorizontalOptions="Center"/>

                                            <!-- - -->
                                            <Frame Grid.Row="2"
                                                   BackgroundColor="#FFFFFF"
                                                   CornerRadius="16"
                                                   HasShadow="False"
                                                   WidthRequest="32"
                                                   HeightRequest="32"
                                                   Padding="0"
                                                   BorderColor="#E0E0E0">
                                                <Frame.GestureRecognizers>
                                                    <TapGestureRecognizer Tapped="OnMenosTapped"
                                                                          CommandParameter="{Binding .}"/>
                                                </Frame.GestureRecognizers>
                                                <Label Text="âˆ’"
                                                       FontSize="18"
                                                       FontAttributes="Bold"
                                                       TextColor="#666666"
                                                       HorizontalOptions="Center"
                                                       VerticalOptions="Center"/>
                                            </Frame>

                                        </Grid>
                                    </Frame>

                                </Grid>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <!-- Mensaje carrito vacÃ­o (opcional) -->
                <VerticalStackLayout x:Name="EmptyCartMessage"
                                     Spacing="16"
                                     Padding="40"
                                     IsVisible="False"
                                     HorizontalOptions="Center"
                                     VerticalOptions="Center">
                    <Label Text="ðŸ›’"
                           FontSize="64"
                           HorizontalOptions="Center"/>
                    <Label Text="Tu carrito estÃ¡ vacÃ­o"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="#1A1A1A"
                           HorizontalOptions="Center"/>
                    <Label Text="Agrega algunos platillos deliciosos"
                           FontSize="14"
                           TextColor="#999999"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>

        <!-- RESUMEN DEL PEDIDO -->
        <Frame Grid.Row="3"
               BackgroundColor="#FFFFFF"
               CornerRadius="0"
               HasShadow="True"
               Padding="24,20"
               Margin="0">

            <VerticalStackLayout Spacing="16">

                <!-- Subtotal -->
                <Grid ColumnDefinitions="*,Auto">
                    <Label Text="Subtotal"
               FontSize="15"
               TextColor="#666666"/>
                    <Label Grid.Column="1"
               x:Name="LblSubtotal"
               FontSize="15"
               TextColor="#1A1A1A"
               HorizontalOptions="End"/>
                </Grid>

                <!-- Servicio -->
                <Grid ColumnDefinitions="*,Auto">
                    <Label Text="Servicio"
               FontSize="15"
               TextColor="#666666"/>
                    <Label Grid.Column="1"
               x:Name="LblServicio"
               FontSize="15"
               TextColor="#1A1A1A"
               HorizontalOptions="End"/>
                </Grid>

                <!-- Separador -->
                <BoxView HeightRequest="1"
             BackgroundColor="#E0E0E0"
             Margin="0,4"/>

                <!-- Total -->
                <Grid ColumnDefinitions="*,Auto">
                    <Label Text="Total"
               FontSize="18"
               TextColor="#1A1A1A"
               FontAttributes="Bold"/>
                    <Label Grid.Column="1"
               x:Name="LblTotal"
               FontSize="20"
               TextColor="#FF6B6B"
               FontAttributes="Bold"
               HorizontalOptions="End"/>
                </Grid>


            <!-- BotÃ³n pagar -->
                <Frame BackgroundColor="#FF6B6B"
                       CornerRadius="28"
                       HasShadow="False"
                       Padding="0"
                       HeightRequest="56"
                       Margin="0,8,0,0">
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnContinuar"/>
                    </Frame.GestureRecognizers>

                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
                        <Label Text="Realizar pedido"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="#FFFFFF"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>

                    </Grid>
                </Frame>

            </VerticalStackLayout>
        </Frame>


        <!-- BOTTOM BAR -->
        <Border Grid.Row="4"
        BackgroundColor="#FFFFFF"
        StrokeThickness="0"
        Margin="1"
        Padding="20,16,20,24">

            <Border.StrokeShape>
                <RoundRectangle CornerRadius="28" />
            </Border.StrokeShape>

            <Border.Shadow>
                <Shadow Brush="#000000"
                Opacity="0.18"
                Radius="18"
                Offset="0,-6" />
            </Border.Shadow>

            <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="0">

                <!-- Home -->
                <VerticalStackLayout Spacing="4">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnHomeTapped" />
                    </VerticalStackLayout.GestureRecognizers>
                    <Label Text="&#xF015;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#CCCCCC"
                   HorizontalOptions="Center" />
                    <Label Text="Inicio"
                   FontSize="11"
                   TextColor="#999999"
                   FontAttributes="Bold"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

                <!-- Carrito -->
                <VerticalStackLayout Grid.Column="1" Spacing="4">

                    <Label Text="&#xF07A;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#FF6B6B"
                   HorizontalOptions="Center" />
                    <Label Text="Carrito"
                   FontSize="11"
                   TextColor="#FF6B6B"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

                <!-- Favoritos -->
                <VerticalStackLayout Grid.Column="2" Spacing="4">
                    <Label Text="&#xF004;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#CCCCCC"
                   HorizontalOptions="Center" />
                    <Label Text="Favoritos"
                   FontSize="11"
                   TextColor="#999999"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

                <!-- Pedidos -->
                <VerticalStackLayout Grid.Column="3" Spacing="4">
                    <Label Text="&#xF0F3;"
                   FontFamily="FASolid"
                   FontSize="24"
                   TextColor="#CCCCCC"
                   HorizontalOptions="Center" />
                    <Label Text="Pedidos"
                   FontSize="11"
                   TextColor="#999999"
                   HorizontalOptions="Center" />
                </VerticalStackLayout>

            </Grid>
        </Border>

    </Grid>
</ContentPage>
